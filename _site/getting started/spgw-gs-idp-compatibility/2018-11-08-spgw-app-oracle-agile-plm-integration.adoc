= Oracle Agile PLM Application Integration Guide
:page-layout: post
:page-category: Tutorials

== Overview

The purpose of this tutorial is to walk you through the single sign-on configuration of Oracle Agile PLM with SPGateway.

== Add Agile ID Asserter

Follow these steps to add the Agile ID asserter.

.  Log in to the WebLogic console.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-01.png[image]
+
.  Click *Security Realms > AgileRealm > Providers*.
.  Click *Lock & Edit*.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-02.png[image]
+
.  Click *New*, and enter or select the following values:
*  *Name*: AgileIdentityAsserter
*  *Type*: AgileIdentityAsserter
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-03.png[image]
+
.  Click *OK*.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-04.png[image]
+
.  Click *AgileIdentityAsserter*.
.  Move the *remote-user* Active Type from *Available* to *Chosen* by selecting it and clicking the right arrow icon.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-05.png[image]
+
.  Click *Save*.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-06.png[image]
+
.  Click the *Providers* tab.
.  Click *DefaultAuthenticator*.
.  Set *Control Flag* to *Sufficient*, and click *Save*.
.  Click the *Providers* tab.
.  Click *AgileIdentityAsserter*.
.  Click *ProviderSpecific*, and disable the *OAMSDKInstall Dir* option.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-07.png[image]
+
. Click the *Providers* tab, and click *Reorder*.
. Select *AgileAuthenticator*, and move it to the top of the list.
. Select *AgileIdentityAsserter*, and move it below the *AgileAuthenticator* row.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-08b.png[image]
+
. Click *OK*.
. Click *Activate Changes*.
. Stop the managed server.

== Apply SSO to Agile Server

Follow these steps to apply SSO to the XMLP server.

.  Log in to the Agile Server console as the _oracle_ user.
.  Navigate to `<Agile Home>/agileDomain/config`, and open *agile.properties* for editing.
.  Add the following lines to the end of the file:
*  `oam.header.name=remote-user`
*  `oam.sso.logout.url=/spgwLogout`
.  Modify the *web.xml* file located at `<Agile Home>/agileDomain/applications/application.ear/application.war/WEB-INF/web.xml`.
.  Create a backup of the current _application.ear_ file.
.  Change `<auth-method>FORM</auth-method>` to `<auth-method>client-cert,form</auth-method>`.
.  Clear the server tmp folder at `<Agile Home>/agileDomain/servers/<Agile Server>/tmp`.
.  Repeat steps 1 through 7 for all managed servers.

== Redeploy Agile PLM Application

.  Log in to the WebLogic console.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-08.png[image]
+
.  Click *Deployments*.
.  Select the *Agile* option, and click *Update*.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-09.png[image]
+
.  Verify the *Source Path* value matches the path of the .ear file from step 4 in the section <<apply-sso-to-agile-server, Apply SSO to Agile Server>> above.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-10.png[image]
+
.  Click *Finish*.
.  Start the managed server.

== Add Agile PLM Application to SPGateway

.  Log in to the SPGateway Admin Console.
.  Click *Applications > Add > Header Based > Create*.
.  Enter the following settings for the application:
*  *Essentials*
**  *Label*: A name end users will recognize in Okta, such as _Agile PLM_.
**  *Public Domain*: The URL you want users to visit for the application, such as _agile.icsynergy.info_.
**  *Protected Web Resource*: Hostname/IP and port the application is hosted on. Ensure you end this value with a forward slash, such as _https://ol6-agile.localdomain:7001/_.
**  *Groups*: The group to which you want to assign the app in the Identity Provider.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-11.png[image]
+
*  *Advanced*
**  *Post Login URL*: The URL to the endpoint where you want the user to land after login. In this case, we want the user to land on _/Agile_. (Example based on previous example values: _https://agile.icsynergy.info/Agile_).
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-12.png[image]
+
*  *Behaviors*
**  Ensure the *Use SPGateway logout page* option is selected in the *Logout* menu.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-13.png[image]
+
.  Click *Next*, and modify the existing header to include the following information:
*  *Data Source*: IdP
*  *Type*: Header
*  *Name*: remote-user
*  *Value*: Attribute being passed from IdP for the userâ€™s username.
+
image:http://support.icsynergy.com/wp-content/uploads/2017/06/agileplm-spgw-14.png[image]
+
.  Click *Next > Done*.
